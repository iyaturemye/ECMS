<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <meta name="viewport" content="width=device-width, 
          initial-scale=1.0, 
          maximum-scale=1.0, 
          user-scalable=no"/>
    <h:head>
        <title>Bidding Page for  #{vehicleDetailsController.choosenVehicle.vehicle.name}</title>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous"/>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Slabo+27px" rel="stylesheet"/> 
        <!--<script src="layout/js/jquery.js"/>-->
        <script src="layout/js/bootstrap.js" type="text/javascript"/>
        <link rel="stylesheet" type="text/css" href="layout/css/style.css"/>
        <link rel="stylesheet" type="text/css" href="layout/css/bootstrap.min.css"/>
        <link href="https://fonts.googleapis.com/css?family=Playfair+Display|Roboto+Condensed" rel="stylesheet"/> 
        <link rel="stylesheet" type="text/css" href="layout/datePicker/jquery-ui.css"/>
        <link rel="stylesheet" href="layout/css/calendar/fullcalendar.min.css"/>
        <link rel="stylesheet" href="layout/css/calendar/fullcalendar.print.min.css"/>
        <link rel="stylesheet" href="layout/css/data-table/bootstrap-table.css"/>
        <link rel="stylesheet" href="layout/css/data-table/bootstrap-editable.css"/>
        <style>
            .container2{
                background: white;
                margin-top: 8%;
                padding: 18px;
                border: 1px solid #ddd;   
            }
            .btnhire2{
                background: white !important;
                color: #41a1ff !important;
            }
            .btns{
                padding: 8px !important;
                border-radius: 5px !important;
                font-family: 'Open Sans Condensed', sans-serif;
            }
            table th{
                font-family: 'Open Sans Condensed', sans-serif;
            }
            .container2{
                font-family: 'Open Sans Condensed', sans-serif;
            }
            .imageContainer{
                font-family: 'Roboto Condensed', sans-serif;
            }
            .leftOne{
                background:#41a1ff;
                color:white;
                padding: 5px;
            }
            .mytableStyle th{
                background:#41a1ff;
                color:white;
                border-bottom: 2px solid #41a1ff !important;
            }
            .mytableStyle td{
                border: 2px solid #41a1ff;
                border-collapse: collapse;
            }
            .mytableStyle{
                border: 2px solid #41a1ff;
            }
            .mysecondTable td{
                border:none !important;
            }
            b, sup, sub, u, del{
                color:#636363 !important;
            }
        </style>
    </h:head>
    <h:body>
        <p:growl />
        <ui:insert>
            <ui:include src="header.xhtml"/>
        </ui:insert>
        <h:form>
            <c:if test="#{!vehicleDetailsController.checkIfAlreadyDone()}">
                <c:if test="#{vehicleDetailsController.isFirstTime}">
                    <div class="container container2" style="margin-bottom: 16.6%;margin-top: 10%;">
                        <div class="row">
                            <div class="col-lg-5">
                                <div style="padding:20px;margin-top: 80px;">
                                    <h2 class="text text-warning" style="font-weight: bold;">You finished your bid on this car</h2>
                                    <span>
                                        Which means you Already  bid on this car before so 
                                        you need to wait for insurance decision their make,
                                        or check in your panel to see if you win or loose on that bid thank u
                                    </span><br/>
                                    <div style="margin-top: 20px;">
                                        <button class="btn btn-info">Continue to bid</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <img src="layout/image/successPage3.jpg"/>
                            </div>
                        </div>
                    </div>
                </c:if>
            </c:if>
            <c:if test="#{!vehicleDetailsController.checkIfAlreadyDone()}">
                <c:if test="#{!vehicleDetailsController.isFirstTime}">
                    <div class="container container2" style="margin-bottom: 16.6%;margin-top: 10%;">
                        <div class="row">
                            <div class="col-lg-5">
                                <div style="padding:20px;margin-top: 80px;">
                                    <h2 class="text text-success" style="font-weight: bold;">
                                       Congratulation your request has been successfull sent 
                                    </h2>
                                    <span>
                                        This means that you has been sent your bid to the insurance ,
                                        insurance will review bid and compare to other bid which sent and 
                                        choose the best for them depend on their needs
                                        thank u
                                    </span><br/>
                                    <div style="margin-top: 20px;">
                                        <button class="btn btn-info">Continue to bid</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-7">
                                <img src="layout/image/successPage3.jpg"/>
                            </div>
                        </div>
                    </div>
                </c:if>
            </c:if>


            <c:if test="#{vehicleDetailsController.checkIfAlreadyDone()}">
                <div class="container container2" style="background:none;border:none;margin-top: 10%;">
                    <div class="row">
                        <div class="col-lg-7 col-lg-offset-2">
                            <p:messages/>
                            <h:commandLink action="#{vehicleDetailsController.bid()}" class="btns btnhire btnhire2" style="margin-bottom: 20px;">
                                <i class="far fa-check-square"></i> Finish your bidd
                            </h:commandLink>

                        </div>
                    </div>
                </div>
                <h:panelGroup id="lists">
                    <div class="container container2" style="margin-top: 0px !important;background:none;border:none;">
                        <div class="row">
                            <!--here we go boss-->
                            <div class="col-lg-7 col-lg-offset-2" style="background:white;border:1px solid #ddd;">
                                <div class="companiesInfo">
                                    <h1 style="color:#41a1ff; "><center><b>Proforma Invoice</b></center></h1>
                                    <div class="pull-right">
                                        <h5>Date:
                                            <h:outputFormat value="#{vehicleDetailsController.todayDate}">
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputFormat>
                                        </h5>
                                    </div>
                                    <div class="garageInfo">
                                        <h3>#{vehicleDetailsController.garageOwner().name.toUpperCase()}</h3>
                                        <h5><b>Address:</b>&nbsp;&nbsp;location</h5>
                                        <h5><b>Phone Number:</b>&nbsp;&nbsp;#{vehicleDetailsController.garageOwner().garageOwner.phoneNumber}</h5>
                                        <h5><b>Website:</b>&nbsp;&nbsp;#{vehicleDetailsController.garageOwner().website}</h5>
                                    </div>
                                </div>
                                <div class="companiesInfo2">
                                    <div class="row">
                                        <div  class="col-lg-4" style="padding: 0px !important;">
                                            <h3 class="leftOne"><b style="color:white !important;">Insurance</b></h3>
                                            <div class="garageInfo">
                                                <h3 style="color:#636363;">#{vehicleDetailsController.choosenVehicle.insurance.name}</h3>
                                                <h5><b>Phone Number:</b>#{vehicleDetailsController.choosenVehicle.insurance.phoneNumber}</h5>
                                            </div>
                                        </div>
                                        <div  class="col-lg-4 col-lg-offset-4 col-xs-offset-4 col-sm-offset-4" style="padding: 0px !important;">
                                            <h3 class="leftOne"><b style="color:white !important;">Car Info</b></h3>
                                            <div class="garageInfo">
                                                <h3 style="color:#636363;">#{vehicleDetailsController.choosenVehicle.vehicle.name}</h3>
                                                <h5><b>Chassis Num:</b>#{vehicleDetailsController.choosenVehicle.vehicle.chasisNum}</h5>
                                                <h5><b>Plate Number:</b>#{vehicleDetailsController.choosenVehicle.vehicle.plateNum}</h5>
                                                <h5><b>Policy Number:</b>#{vehicleDetailsController.choosenVehicle.vehicle.policyNumber}</h5>
                                                <h5><b>Location:</b>#{vehicleDetailsController.choosenVehicle.location}</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tableInfo">
                                    <table class="table mytableStyle">
                                        <thead>
                                            <th>ITEM</th>
                                            <th>DESCRIPTION</th>
                                            <th>QTY</th>
                                            <th>PART NUMBER</th>
                                            <th>CONDITION</th>
                                            <th>UNIT PRICE</th>
                                            <th>TOTAL PRICE</th>
                                            <th>ACTION</th>
                                        </thead>
                                        <tbody>
                                            <c:forEach items="#{vehicleDetailsController.lisofQuotation}" var="i" varStatus="status">
                                                <c:if test="#{i.brokenCarPart.carsparepart!=null}">
                                                    <tr>
                                                        <td>${status.index + 1}</td>
                                                        <td>#{i.brokenCarPart.carsparepart.name}</td>
                                                        <td>#{i.brokenCarPart.quantity}</td>
                                                        <td>#{i.brokenCarPart.partNumber}</td>
                                                        <td>#{i.brokenCarPart.status}</td>
                                                        <td>
                                                            <h:outputText value="#{i.price}">
                                                                <f:convertNumber pattern="###,###,###"/>
                                                            </h:outputText>

                                                        </td>
                                                        <td>
                                                            <h:outputText value="#{i.price * i.brokenCarPart.quantity}">
                                                                <f:convertNumber pattern="###,###,###"/>
                                                            </h:outputText>


                                                            FRW</td>
                                                        <td>
                                                            <h:form>
                                                                <h:commandLink title="Add price" class="addnew" >
                                                                    <i class="fa fa-plus"></i>
                                                                    <f:ajax listener="#{vehicleDetailsController.addPriceToQuotation(i)}"  onevent="displayPopupform"/>
                                                                </h:commandLink>
                                                            </h:form>
                                                        </td>
                                                    </tr>
                                                </c:if>
                                            </c:forEach>
                                        </tbody>
                                    </table>
                                    <h4>Additional Information</h4>
                                    <table class="table mytableStyle">
                                        <thead>
                                            <th>ITEM</th>
                                            <th>DESCRIPTION</th>
                                            <th>PRICE</th>
                                            <th>ACTION</th>
                                        </thead>
                                        <tbody>
                                            <c:forEach items="#{vehicleDetailsController.lisofQuotation}" var="i" varStatus="status">
                                                <c:if test="#{i.brokenCarPart.carsparepart==null}">
                                                    <tr>
                                                        <td>${status.index + 1}</td>
                                                        <td>#{i.brokenCarPart.additionInfo.description}</td>
                                                        <td>
                                                            <h:outputText value="#{i.price}">
                                                                <f:convertNumber pattern="###,###,###"/>
                                                            </h:outputText>
                                                        </td>
                                                        <td>
                                                            <h:form>
                                                                <h:commandLink title="Add price" class="addnew" >
                                                                    <i class="fa fa-plus"></i>
                                                                    <f:ajax listener="#{vehicleDetailsController.addPriceToQuotation(i)}"  onevent="displayPopupform"/>
                                                                </h:commandLink>
                                                            </h:form>
                                                        </td>
                                                    </tr>
                                                </c:if>
                                            </c:forEach>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="line" style="border-bottom: 1px solid #ddd;"></div>
                                <div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <h4>Service</h4>
                                            <small><a href="#" class="newService">Add Other Service</a></small>
                                            <h:panelGroup id="garageQuotation">
                                                <table class="table mytableStyle">
                                                    <thead>
                                                        <th>ITEM</th>
                                                        <th>DESCRIPTION</th>
                                                        <th>PRICE</th>
                                                        <th>ACTION</th>
                                                    </thead>
                                                    <tbody>
                                                        <c:forEach items="#{vehicleDetailsController.garageQuotationDetails}" var="i" varStatus="status">
                                                            <tr>
                                                                <td>${status.index + 1}</td>
                                                                <td>#{i.brokenCarPart.additionInfo.description}</td>
                                                                <td>#{i.price}</td>
                                                                <td>
                                                                    <h:form>
                                                                        <h:commandLink title="remove" class="addnew" >
                                                                            <i class="fa fa-trash"></i>
                                                                            <f:ajax listener="#{vehicleDetailsController.removeQuotation(i)}" render="garageQuotation"/>
                                                                        </h:commandLink>
                                                                    </h:form>
                                                                </td>
                                                            </tr>
                                                        </c:forEach>
                                                    </tbody>
                                                </table>
                                            </h:panelGroup>
                                        </div>
                                    </div>
                                </div>
                                <div class="totalDiv">
                                    <div class="row" >
                                        <div class="col-lg-4">
                                            <b>estimate Date and time when work will be done:</b>
                                            <p:calendar required="true" requiredMessage="Estimate time and date to the work to be done" value="#{vehicleDetailsController.estimatedDate}" pattern="dd-MM-yyyy" placeholder="19/09/1990" mindate="#{vehicleDetailsController.toDayDate()}"/>
                                        </div>
                                        <div class="col-lg-3 col-lg-offset-5" style="padding: 0px;text-align: right;">
                                            <table class="table mysecondTable">
                                                <tr>
                                                    <td><b>SUBTOTAL</b></td>
                                                    <td><h:outputFormat value="#{vehicleDetailsController.subTotal}">
                                                            <f:convertNumber pattern="###,###,###"/>
                                                        </h:outputFormat> FRW </td>
                                                </tr>
                                                <tr>
                                                    <td><b>TAX</b></td>
                                                    <td>
                                                        <h:outputFormat value="#{vehicleDetailsController.tax}">
                                                            <f:convertNumber pattern="###,###,###"/>
                                                        </h:outputFormat> FRW </td>
                                                </tr >
                                                <tr style="border-top: 5px solid #ddd;">
                                                    <td><b>TOTAL:</b></td>
                                                    <td>
                                                        <h:outputFormat value="#{vehicleDetailsController.totalAmount}">
                                                            <f:convertNumber pattern="###,###,###"/>
                                                        </h:outputFormat> FRW </td>
                                                </tr>

                                            </table>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </h:panelGroup>
            </c:if>
        </h:form>
        <!--car information-->
        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog"  aria-labelledby="myModalLabel" aria-hidden="true">
            <h:panelGroup id="infoPanel">
                <div class="modal-dialog">
                    <h:form class="form-horizontal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" id="myModalLabel">
                                    Add new Info
                                </h4>
                                <button type="button" class="close"  data-dismiss="modal" aria-hidden="true">
                                    &times;
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label class="col-lg-3">Price</label>
                                    <div class="col-lg-6">
                                        <h:inputText class="form-control" value="#{vehicleDetailsController.chooseQuotationForPrice.price}" required="true" requiredMessage="Price is required"></h:inputText>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close
                                </button>
                                <h:commandButton action="#{vehicleDetailsController.chooseAction()}" value="#{vehicleDetailsController.text}" class="btn btn-primary addToit">
                                </h:commandButton>
                            </div>
                        </div><!-- /.modal-content -->
                    </h:form>
                </div><!-- /.modal -->
            </h:panelGroup>

        </div>


        <!-- Modal -->
        <div class="modal fade" id="anotherModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="myModalLabel">
                            Provide your service information
                        </h4>
                        <button type="button" class="close" 
                                data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>

                    </div>
                    <h:form class="horizontal">
                        <div class="modal-body">
                            <div class="form-group">
                                <label class="col-lg-4">
                                    Price
                                </label>
                                <div class="col-lg-8">
                                    <h:inputText value="#{vehicleDetailsController.amount}" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-lg-12">Job Description</label>
                            </div>
                            <div class="form-group">
                                <label class="col-lg-12">
                                    <h:inputTextarea value="#{vehicleDetailsController.additionalBrokenCarPart.description}" class="form-control" rows="3">

                                    </h:inputTextarea>
                                </label>
                            </div>
                            <div style="height: 30px;"></div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" 
                                    data-dismiss="modal">Close
                            </button>
                            <h:commandButton class="btn btn-primary" action="#{vehicleDetailsController.addGarageInformation()}" value="Submit"/>
                        </div>
                    </h:form>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>

        <ui:insert>
            <ui:include src="footer.xhtml"/>
        </ui:insert>



        <script src="layout/datePicker/jquery-ui.js"></script>
        <!--<script src="layout/js/jquery.js"/>-->
        <script>
            var displayPopupform = function (data) {
                if (data.status === "success") {
                    $('#myModal').modal('show');
                }
            }
            $(".addnew").click(function () {
            });
            $(".edit").click(function () {
                $('#myModal').modal('show');
            });
            $(function () {
                $("#estimatedDate").datepicker();
                $("#mobile-nav-toggle").find("i").attr("class", "fas fa-align-justify");
                $(".newService").click(function () {
                    $("#anotherModel").modal('show');
                });
            });
        </script>

        <!--<script src="layout/js/jquery.js"></script>-->
        <!--<script src="layout/js/popper.min.js"></script>-->
        <script src="layout/js/bootstrap.js"></script>			
        <script src="layout/js/easing.min.js"></script>			
        <script src="layout/js/hoverIntent.js"></script>
        <script src="layout/js/superfish.min.js"></script>	
        <!--<script src="layout/js/jquery.ajaxchimp.min.js"></script>-->
        <script src="layout/js/jquery.magnific-popup.min.js"></script>	
        <!--<script src="layout/js/jquery.tabs.min.js"></script>-->						
        <script src="layout/js/jquery.nice-select.min.js"></script>	
        <script src="layout/js/isotope.pkgd.min.js"></script>			
        <script src="layout/js/waypoints.min.js"></script>
        <script src="layout/js/jquery.counterup.min.js"></script>
        <script src="layout/js/simple-skillbar.js"></script>							
        <script src="layout/js/owl.carousel.min.js"></script>							
        <script src="layout/js/mail-script.js"></script>	
        <script src="layout/js/main.js"></script>


    </h:body>
</html>

